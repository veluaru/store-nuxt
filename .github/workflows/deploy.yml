name: Build and Deploy
on: 
  push:
    branches:
      - main
      - master

# Permisos requeridos para que JamesIves/github-pages-deploy-action pueda
# crear la rama 'gh-pages' y hacer el push de los archivos.
permissions:
  contents: write

jobs:
  build-and-deploy:
    # Garantiza que solo se ejecute un build a la vez por ref
    concurrency: ci-${{ github.ref }} 
    runs-on: ubuntu-latest

    steps:
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@v4 # Actualizado a v4

    - name: Setup Node.js ğŸ”§
      uses: actions/setup-node@v4
      with:
        node-version: 18

    - name: Install & Generate (Build EstÃ¡tico) âš™ï¸
      run: |
        npm ci
        # Genera los archivos estÃ¡ticos en la carpeta 'dist'
        npm run generate

    - name: Deploy to GitHub Pages ğŸš€
      # Usa la acciÃ³n JamesIves para enviar la carpeta 'dist' a la rama 'gh-pages'
      uses: JamesIves/github-pages-deploy-action@v4
      with:
        folder: dist
        # El token GITHUB_TOKEN es proporcionado automÃ¡ticamente por GitHub